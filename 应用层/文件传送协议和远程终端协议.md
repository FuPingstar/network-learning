#### 文件传送协议

##### FTP（File Transfer Protocol）

1. 概述

   + FTP是一个用于在计算机网络上在客户端和服务器之间进行文件传输的应用层协议。

   + FTP提供交互式的访问，**允许客户指定文件的类型与格式（如指明是否使用ASSIC码），并允许文件具有存取权限（如访问文件的用户必须进行授权,并输入有效的口令）。FTP屏蔽了计算机系统的细节，因而适合在异构网络中任意计算机之间传送文件**。
   + FTP基于TCP,是文件共享协议中的一大类，即复制整合文件。特点是：若要存取一个文件，就必须获取一个本地的一个文件副本，如果要修改文件，只能对文件的副本进行修改，然后将修改后的文件副本传回到原节点。
   + FTP一般运行在20和21两个端口上，端口20用于在客户端和服务器之间传输数据流，端口21用于传输控制流。

2. FTP实现的目标

   + 促进文件的共享（计算机程序或数据）
   + 鼓励间接或者隐式的使用远程计算机
   + 向用户屏蔽了不同主机上各种文件存储系统的细节
   + 可靠和高效的传输数据

3. 基本工作原理

   + FTP使用的是客户服务器方式。一个FTP服务器进程可以同时为多个客户进程提供服务。FTP的服务器进程由两大部分组成：一个主进程，负责接收新的请求；另外有若干个从属进程，负责处理单个请求。

   + 主进程的工作步骤：

     + 打开熟知端口（21），使客户进程能够连接上。
     + 等待客户进程发出连接请求
     + 启动从属进程来处理客户进程发来的请求。从属进程对客户进程的请求处理完毕后即终止，但从属进程在运行期间根据需要还可能创建其他子进程。
     + 回到等待状态，继续接受其他客户进程发来的请求。主进程与从属进程的处理是并发的进行。

     ![FTP工作原理](/images/应用层/FTP工作原理.jpg)

     图中的服务器有两个从属进程：控制进程和从属进程，主进程没有画出。

   + FTP连接创建遵循以下步骤：

     **注意：进行文件传输时，FTP客户和服务器之间要建立两个并行的TCP连接：控制连接和数据连接，控制连接在整个会话期间一直打开，FTP客户所发出的传送请求，通过控制连接发送给服务器端的控制进程。但控制连接并不用来传送文件，实际用来传送文件的数据连接。服务器端的控制进程在接收到FTP客户发来的文件传输请求后，就创建数据传送进程和数据连接，用来连接客户端和服务器的数据传送进程。数据传送进程实际完成文件的传送，在传送完毕后关闭数据传送连接并结束运行。**

     + 客户端打开一个随机的端口（端口号大于1024，在这里，我们称它为x），同时一个FTP进程连接至服务器的21号命令端口。此时，该tcp连接的来源地端口为客户端指定的随机端口x，目的地端口（远程端口）为服务器上的21号端口。
     + 客户端开始监听端口（x+1），同时向服务器发送一个端口命令（通过服务器的21号命令端口），此命令告诉服务器客户端正在监听的端口号并且已准备好从此端口接收数据。这个端口就是我们所知的数据端口。
     + 服务器打开20号源端口并且创建和客户端数据端口的连接。此时，来源地的端口为20，远程数据(目的地)端口为（x+1）。
     + 客户端通过本地的数据端口创建一个和服务器20号端口的连接，然后向服务器发送一个应答，告诉服务器它已经创建好了一个连接。

     **FTP使用了一个分离的控制连接因此FTP的控制信息是带外传送的。FTP使用了两个不同的端口，所以数据连接和控制连接不会发生混乱。**

4. 主动模式和被动模式

   FTP有两种使用模式：主动和被动。主动模式要求客户端和服务器端同时打开并且监听一个端口以创建连接。在这种情况下，客户端由于安装了防火墙会产生一些问题。所以，创立了被动模式。被动模式只要求服务器端产生一个监听相应端口的进程，这样就可以绕过客户端安装了防火墙的问题。

[ubuntu搭建ftp服务](<https://blog.csdn.net/a327915304/article/details/78308262>)

##### TFTP





#### 远程终端协议

##### TELNET

1. 概述
   + TELNET是一种应用层协议，使用于互联网及局域网中，使用终端虚拟机的形式，提供双向、以文字字符串为主的命令行接口交互功能。是一个简单的远程终端协议，也是因特网的正式标准。
2. 原理
   + 用户首先在计算机上运行TELNET程序，连线至目的服务器，然后输入账号和密码验证身份。用户可以在本地主机输入命令，然后让已连接的远程主机运行，就像直接在对方的控制台上输入一样。
   + 传统的TELNET会话所传输的数据并未加密，账号和密码等敏感数据容易被窃听，因此很多服务都会屏蔽TELNET服务，改用更安全的SSH。
3. NVT
   + TELNET能够适应许多计算机的操作系统的差异，为了适应这种差异，TELNET定义了命令和数据应怎样通过因特网，这些定义就是所谓的网络虚拟终端NVT（NetWork Virtual Terminal）。
   + 客户端软件把用户的击键和命令转化成NVT格式，并送交服务器。服务器软件把收到的数据和命令，从NVT格式转换成原地系统所需的格式。向用户返回数据时，服务器把原地系统的格式转换成NVT格式，本地用户再从NVT格式转换到本地系统所需的格式。

[ubuntu使用telnet](<https://blog.csdn.net/zxc024000/article/details/81272714>)

